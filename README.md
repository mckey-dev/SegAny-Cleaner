# SAM2 Image Cropping Tool (Ver 1.1.1)

Metaの「Segment Anything Model 2 (SAM2)」を利用した高精度な画像切り抜きツールです。
Paperspace（Gradient）環境に最適化されており、システム側の高速なTorchを継承して動作します。

## 🚀 主な機能
- **SAM2による自動解析**: クリック不要で画像内のオブジェクトを一括認識。
- **直感的ななぞり選択**: 解析後の色付き領域をなぞるだけで対象を指定。
- **消しゴム編集**: マスク生成後、不要な部分をブラシで消去可能。
- **プロ仕様の仕上げ**: 
    - **境界ぼかし (px)**: 切り抜き境界を滑らかにし、合成時の違和感を解消。
    - **透過PNG自動出力**: 入力形式に関わらず、透過情報を保持したPNGで保存。
    - **反転機能**: オブジェクト除去（背景残し）にも対応。

## 🛠 セットアップ (Paperspace)
1. **ノートブックの実行**: `SegAny-Cleaner.ipynb` を開いて実行します。
2. **システム継承**: `--system-site-packages` オプションにより、環境に最適化されたTorchを使用します。
3. **依存関係の解決**: Ver 1.1.1では `torchaudio` の依存をカットし、インストール時のエラーを回避しています。

## 📖 使い方
1. **解析**: 画像をアップロードし「解析実行」をクリック。
2. **選択**: 解析画像（セグメント）の上をペンでなぞり「マスク生成」。
3. **修正**: マスク結果に不要な箇所があればペン（消しゴム）で消去。
4. **調整**: 「切り抜き調整」アコーディオンを開き、ぼかしや反転を設定。
5. **出力**: 「切り抜き実行」で最終結果をダウンロード。

## ⚠️ 注意事項
- **初回起動**: モデル（Tiny/Small/Base+/Large）の初回選択時に自動ダウンロードが発生します（`/tmp/sac/models/`）。
- **透過保存**: 境界ぼかしを適用した場合、透明度（Alpha）を維持するため必ずPNG形式で保存されます。

---
**Version**: 1.1.1  
**Update**: Added Edge Blurring, Auto-PNG conversion, and Dependency Error Fix.
